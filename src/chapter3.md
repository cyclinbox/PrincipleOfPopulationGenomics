# 第3章 随机遗传漂变

<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><a href="index.html"> <i class="fa fa-arrow-left"></i><b> 返回目录 </b></a>

<div style="position:fixed;height:20px;right:50px;bottom:80px;background-color:#ddd;color:#069;padding:5px;border-radius:20px;box-shadow:0px 0px 4px #aaa;cursor:pointer;" onclick="javascript:window.location.href='#top'"><i class="fa fa-arrow-up"></i><b> 返回顶部 </b></div>




在每一个生物体中，形成的配子数量都远远超过了可存活后代的数量。这是达尔文自然选择理论的原理之一。哪一个特定的配子存活，哪一个死亡，一定程度上由偶然性决定：抽签的运气。随机因素意味着，偶然因素本身就可以改变一代又一代的等位基因频率。因为这样的采样过程不会以任何预定的方式改变等位基因频率，所以这个过程被称为 **随机遗传漂变（random genetic drift）** 。随机遗传漂变的微妙性和重要性是本章的主题。

## 3.1 随机遗传漂变和二项抽样

为了介绍随机遗传漂变的过程，我们首先考虑一个具有等位基因A和a的哈迪-温伯格平衡的大种群，其等位基因频率 $p=q=\frac{1}{2}$ 。在该群体中，基因型频率为 $\frac{1}{4}$ AA、$\frac{1}{2}$ Aa、$\frac{1}{4}$ aa。假设群体“崩溃”，并且只有四个随机选择的个体存活下来，使这个群体永久存在。仅凭偶然的机会，幸存者可能由四个AA个体组成：这种可能性有 $(\frac{1}{4})^4=\frac{1}{256}$ 。同样，四个个体的基因型全为aa的可能性也是如此。任何其他可能的基因型组合都可以通过这种思路求得，并且不难计算出每个组合的概率。如果新群体的规模保持在每一代只有四个个体，这种类型的随机抽样每一代都会发生。如果新群体的规模保持在每一代只有四个个体，这种类型的随机抽样每一代都会发生。在任何生殖周期中，基因频率都有可能发生纯粹由采样过程引起的巨大变化。随机漂变的一个结果很快变得清楚：最终，群体将要么拥有所有A等位基因，要么拥有所有a等位基因。原因是，一旦群体达到这种“固定”状态，这种变化就会停滞。只有新的突变或迁移到群体中才能重新引入变异。

在上面的例子中，我们每代抽样四个二倍体个体。如果交配是随机进行的，那么对四个二倍体个体进行抽样完全等同于对八个单倍体配子进行抽样。当从 $p=\frac{1}{2}$ 的群体中随机抽取八个配子时，有九种可能的结果，在这九种可能结果中A等位基因的拷贝数分别为0,1,2,3，…… 8 个，其余为a等位基因的拷贝。九种可能性中的每一种的概率由 **二项分布（binomial distribution）** 给出，对应于 $(\frac{1}{2}A+\frac{1}{2}a)^8$ 的展开式中的连续项的系数。由于每一次连续抽取被认为是独立的，并且有 $\frac{1}{2}$ 的机会抽到一个A等位基因，这意味着抽取八个连续的A等位基因的概率为 $(\frac{1}{2})^8=\frac{1}{256}$ 。结果与前面计算的抽取四个AA基因型的概率相同，它说明了随机交配的原理。二倍体个体的随机抽样相当于单倍体配子的两倍随机抽样。

图3.1描述了从有限种群中抽取配子的过程。这些假设与产生哈迪-温伯格频率的假设相同，但在这种情况下，由于种群规模有限，等位基因频率可能会随着世代发生变化。在图3.1中的模型中，每一代的可育成年个体包括N个二倍体个体。这些个体产生了一个基本上无限的配子池，其中的等位基因频率与成年个体的相同。从这个无限的配子池中，随机抽取2N个并结合，形成下一代的合子。采样过程的这个模型产生了A和a的所有可能组合的二项分布。

![](asset/fig3.1.png)

举一个具体的例子，一个由9个二倍体生物组成的群体仅代表一个含有18个配子的样本，但这些配子可以被认为是从一个基本上无限的配子池中取样的。由于小样本通常不具有代表性，样本中的等位基因频率可能与整个配子池中的频率不同。例如，假设一个配子池包含频率分别为 $p$ 和 $q$ 的等位基因A和a， $p+q=1$ 。然后，如果随机抽取2N个配子以产生下一代的合子，则样本中恰好包含 $j$ 个等位基因A的概率由下列二项分布频率给出：

$$
\begin{aligned}   
    Pr\{j \text{个等位基因A}\}&=C^j_{2N}p^jq^{2N-j}\\
    &=\frac{(2N)!}{j!(2N-j)!}p^jq^{2N-j} \tag{3.1}
\end{aligned}
$$

其中 $j$ 可以取 0到2N之间的任何整数值。二项式系数（中间表达式中的括号内）通常读为“C 2N取j”（英文中的读法为“two N choose j”），因为它是从总共 $2N$ 个元素中选择 $j$ 个元素的方法数量。在等式（3.1）中所示的一代随机抽样后，A在群体中的新等位基因频率（称为 $p'$ ）由 $j/(2N)$ 给出，因为根据定义，A的等位基因频率等于A等位基因的数量（在这种情况下为 $j$ ）除以总数（在这种情形下为 $2N$ ）。在下一代中，采样过程根据等式（3.1）重新进行， $p$ 替换为 $p'$ ，$q$ 替换为 $1-p'$ 。这样，等位基因频率可以在一代又一代之间随机变化。

图3.2是根据等式（3.1）对随机抽样的过程进行的计算机模拟的结果。图3.2A中的每一行给出了 $N=9$ （即 $2n=18$ ） 的群体中连续20个世代里等位基因A的数量变化。正如你所看到的，单个的群体的行为非常不稳定。在7个群体中，等位基因A发生了 **固定（fixed）** ，即 $p=1$ ；在5个群体中，等位基因A发生了 **丢失（lost）** ，即 $p=0$ 。在其他8个群体中，A和a都保持未固定的状态，或者说这两个等位基因依然是 **分离的（segregating）** ；然而，未固定群体中的最终等位基因频率很可能是一个不同于初始频率 $p=0.5$ 的其他值。图3.2B显示了 $2N=100$ 条件下的模拟结果。随着种群规模的增加，种群固定的速度明显变慢。图3.2的主要结论是，等位基因频率在任何一个群体中都表现得如此不稳定，以至于几乎不可能进行预测。

![](asset/fig3.2.png)

尽管由于任何单个群体中的随机遗传漂变导致的等位基因频率的变化可能无法预测，但我们可以预测大量群体中等位基因频率的 *平均* 行为。我们现在考虑大数量的多个群体，所有这些群体具有相同的初始等位基因频率和相同的群体大小 $N$ 。假设这些种群中的每一个都独立于其他种群经历漂变。并且假定除了它们的群体大小有限以外，所有亚群都满足哈迪-温伯格模型的所有假设，并附加规定：（1）雄性和雌性数量相等；（2）每个个体都有相同的机会为下一代贡献成功的配子。如图3.3所示，这里的关键点在于，我们可以通过考虑图中不同时间点的时间切片并统计具有特定等位基因频率的种群数量的直方图，来描述这些种群在等位基因的频率上是如何变化的。最初，种群将全部接近初始等位基因频率。随着时间的推移，这些种群“漂变”开来，最终它们在所有可能的等位基因频率上扩散开来。最后，正如我们将看到的，每个种群必须对一个或另一个等位基因进行固定。

![](asset/fig3.3.png)

要理解为什么最终的固定或丢失是不可避免的，可以考虑一个无限长的保龄球道，它有一些微小的缺陷，这些缺陷会以某种方式取代一个想象中的无重量保龄球。由于球没有质量，它没有动量，因此在每一刻都会受到球道的颠簸的影响。这意味着，就像等位基因频率一样，保龄球的未来只取决于它现在的位置，而不取决于它是如何到达那里的。沟槽代表了 $p=0$ 和 $p=1$ 的固定状态。一旦球进入沟槽，它就不能再出来。保龄球道的缺陷使球无法直线滚动，最终它会滚入一个或另一个沟槽。在这个类比中，群体的大小对应于保龄球道的宽度；群体越大意味着球道越宽。此时，虽然球道上的缺陷仍然会使球偏转，但这样的偏转与球道的宽度相比小了很多，球的Z字形偏转幅度更小。因此，球在沟外停留的时间更长，类似于较大群体中等位基因的固定时间更长，但最终球会落入沟槽中。

为了充分理解随机遗传漂变，我们必须学习如何推导图3.3中绘制的等位基因频率分布。我们刚刚描述了一代人之后会发生的情况，这组人群将具有一系列等位基因的频率，如等式（3.1）中的二项分布所描述的那样。二项分布为我们提供了一个群体在一代漂变之后具有等位基因概率 $p'$ 的概率。如果我们考虑到1000个初始等位基因频率 $p$ 的群体，那么二项分布给出了在经历一代漂变之后等位基因频率 $p'$ 的概率分布。那么下一代呢？对于每一个群体，我们可以将整个抽样过程看作重新开始。因为没有一个群体记得上一代的情况，所以每一代群体中都会重新进行二项抽样。但是，由于等位基因频率发生变化，新的等位基因频率必须在等式（3.1）中使用。对于1000个群体，等式（3.1）必须单独应用于每个群体，然后在这些分布中求和，以获得随机漂移的每个可能结果的总体概率。幸运的是，在我们检查了下面的实验之后，有一种更简单的方法。

按照图3.3设计的实际实验得出了图3.4所示的结果。该图显示了107个黑腹果蝇亚群中19代随机遗传漂变的历史。每个亚群由16只杂合的 $bw^{75}/bw$ 果蝇组成（ $bw$ =brown eyes棕色眼睛），并通过随机选择8只雄性和8只雌性来产生下一代来保持16只个体的恒定大小。图3.4中的每个直方图给出了包含0,1,2，……32个 $bw^{75}$ 等位基因的亚群体数量。图3.4中等位基因频率的变化模式起初看起来很复杂，但实际上发生了一件简单的事情。当固定了等位基因 $bw^{75}$ 或 $bw$ 的群体开始在边界堆积时，等位基因频率最初的那个呈驼峰状的分布逐渐变平。群体在边界处的堆积是因为，一旦等位基因被一个群体固定或丢失，其在这个群体中将会一直保持固定或丢失的状态不变，因为如此短的世代中，小群体中的突变可以忽略不计。经过19代漂变之后，大多数亚群体都固定了两个等位基因中的一个，而在还没有固定等位基因的群体中，等位基因频率的概率分布基本上是平的。

![](asset/fig3.4.png)

--------------------

**问题3.1**

考虑一个小荒岛上的自花授粉植物的群体，这个群体最开始由一个杂合子个体组成，基因型为Aa。假设这株植物开花结实后死亡，因此世代之间是离散的，并且整个群体只能由一株植物组成。到第二代时，这个群体中基因纯合的概率是多少？

---------

**答案**

第一代后代是AA的几率是 $\frac{1}{4}$ ，而它是aa的几率也是 $\frac{1}{4}$ ，因此在一代中固定的几率是 $\frac{1}{2}$ 。如果第一代后代为Aa，那么第二代中固定（假设种群在第一代中没有固定）的几率也是 $\frac{1}{2}$ 。因此，在第一代中没有固定，而在第二代中固定的几率是  $\frac{1}{2}\times\frac{1}{2}=\frac{1}{4}$ 。再加上第一代中固定的概率（ $\frac{1}{2}$ ），我们得到  $\frac{1}{2}+\frac{1}{4}=\frac{3}{4}$ 为这个基因在第二代中固定的概率。注意，每一代中不固定的概率是 $\frac{1}{2}$ ，因此在第二代中该基因依然没有固定的概率是 $\frac{1}{2}\times\frac{1}{2}$ ，等于 $1-\frac{3}{4}$ 。

-------------------

## 3.2 随机遗传漂变的Wright-Fisher模型

在前面的等式（3.1）中描述了一种带有二项分布随机抽样的随机遗传漂变模型，这就是著名的 **Wright-Fisher模型** ，因为费希尔（Fisher）（1930）和怀特（Wright）（1931）推导出了亚群中的等位基因频率的期望分布。尽管两位作者都没有用这里所用的方式来表述问题，但我们的方法使问题变得更简单，并给出了相同的结果。如果一个群体包含 $2N$ 个等位基因，其中可能存在两个等位基因A和a，那么群体的状态可以用群体中A等位基因的数量来描述。群体可能的状态是 $0,1,2,...2N$ 。状态 $0$ 和 $2N$ 是特殊的，因为它们代表了一种等位基因被固定的状态，一旦种群进入这两种状态中的任何一种，就无法离开，除非出现新的突变（在目前的讨论中我们排除了这种可能性）。状态 $0$ 与 $2N$ 被称为 *吸收状态（absorbing states）* 。从任何非固定的等位基因频率开始，群体都有可能漂变到任何其他等位基因的频率。然而，种群更可能保持在一个接近于当前状态的新状态，而不是大幅跳跃。如图3.4所示，如果 $2N=32$ ，则一代中基因A的数量从30个拷贝的漂移到29个拷贝的概率为0.186，而漂移到27个拷贝的概率为0.033。种群从具有 $i$ 个拷贝的等位基因A的状态漂移到 $j$ 个拷贝的状态的概率称为 *转移概率（transition probability）* 。Wright-Fisher模型的转移概率直接从二项分布（见方程3.1）获得。特别的，对于一个含有 $i$ 个拷贝的等位基因A和 $2N-i$ 个拷贝的等位基因a的群体，则转移概率 $T_{ij}$ 由下式给出：

$$
T_{ij}=C_{2N}^i(\frac{i}{2N})^j(\frac{2N-i}{2N})^{2N-j}\\
=\frac{(2N)!}{j!(2N-j)!}p^jq^{2N-j} \tag{3.2}
$$

其中， $p=i/2N$ 是等位基因A的初始频率，而 $q=(2N-i)/2N$ 是等位基因a的初始频率。


转移概率可以放在一个方阵 $\bm{T}$ 中，其中矩阵元素 $T_{ij}$ 给出了从状态 $i$ 到状态 $j$ 的转移概率， $i,j=0,1,2,...,2N$ 。矩阵 $\bm{T}$ 包含了预测经过几代随机遗传漂变以后，群体预期分布所需的所有信息，如图3.4所示。这类模型的状态是离散的，并且从一个状态到另一个状态的转移概率固定，这样的模型被称为 **马尔可夫链（Markov chain）** ，它具有一些非常优雅的数学性质。Wright Fisher模型的迭代给出了纯漂变过程的预期结果（图3.5）。几分钟后，我们将使用Wright Fisher模型来展示关于固定概率的重要结果。

![](asset/fig3.5.png)

-----------------

**问题3.2**

考虑一个由四个二倍体个体组成的群体。这个群体具有四个等位基因A的拷贝（等位基因A的频率 $p=\frac{1}{2}$ ），计算经过一代的遗传漂变以后，群体中等位基因A的拷贝数变成3个的概率。如果经过一代漂变后，等位基因A的拷贝数还是4个呢？变成5个呢？计算它们的概率。现在考虑一个相同大小的群体，但最初拥有两个拷贝A。漂变到1个、2个或3个拷贝的概率是多少？

---------

**答案**

应用方程（3.2），我们得到 $T_{43}=[8!/(5!3!)](1/2)^8=7/32=0.219$ 。同理， $T_{44}=[8!/(4!4!)](1/2)^8=70/256=0.273$ ， $T_{45}=T_{43}=7/32=0.219$ 。（注意，二项分布关于 $p=\frac{1}{2}$ 对应的 $k$ 对称，这里 $p(k=4)=\frac{1}{2}$ ，因此这里的  $T_{43}$ 和 $T_{45}$ ，概率是相等的）。在初始频率为 $\frac{2}{8}$ 的情况下，我们得到 $T_{21}=[8!/(1!7!)](\frac{1}{4})(\frac{3}{4})^7=0.267,\ T_{22}=[8!/(2!6!)](\frac{1}{4})^2(\frac{3}{4})^6=0.311,\  T_{23}=[8!/(3!5!)](\frac{1}{4})^3(\frac{3}{4})^5=0.208$ 

-----------

**问题3.3**

Moran（1958）提出了一种随机遗传漂变的替代公式【译者按：与离散世代的Wright Fisher模型不同，Moran模型认为世代之间是连续的】。该模型具有相当大的直觉吸引力，它还允许针对不同数量的进化兴趣推导出显式表达式（Ewens 2004）。Moran模型严格适用于单倍体群体，但为了使其与Wright Fisher模型相比较，我们将假设一个拥有 $2N$ 个单倍体个体的群体。在每一代中，遗传漂变的过程从随机抽取两个个体开始，这里的抽样过程是有放回抽样（sampling with replacement），这意味着同一个体可以被抽到两次。如果随机抽到的是两个不同的个体，则随机选择其中一个来产生单个后代，并将这个个体和其后代放回到群体中；同时丢弃另一个个体。如果随机抽取到的是同一个个体，则只将这个个体的后代放回群体中。在Moran模型中，如果包含 $2N$ 个单倍体个体的群体中含有 $i$ 个等位基因A和 $2N-i$ 个等位基因a，那么转移概率 $T_{ij}$ 只在 $j=i-1,\ j=i,\ j=i+1$ 时非零，其他情况时均为0。Moran模型的转移概率由下面的式子给出：

$$
\begin{aligned}
T_{ii}&=\frac{i^2+(2N-i)^2}{(2N)^2}=p^2+q^2\\
T_{ij}&=\frac{i(2N-i)}{(2N)^2}=pq,\ (j=i+1或j=i-1) \tag{3.3}
\end{aligned}
$$

对于问题3.2中给出的示例，用Moran模型计算转移概率。

------------------

**答案**

将等式（3.3）应用于 $p=\frac{4}{8}$ 的情况，我们得到 $T_{34}=0.25,\ T_{44}=0.50,\ T_{45}=0.25$ ；对于 $p=\frac{2}{8}$ 的情况，我们得到 $T_{21}=0.1875,\ T_{22}=0.6250,\ T_{23}=0.1875$ 。与Wright-Fisher模型不同，Moran模型无论是保持等位基因数量不变，还是增加或减少恰好1个等位基因，转变概率总和为1。

-------------------

Wright Fisher模型和Moran模型都包含了随机遗传漂变的一个重要特征。这就是当等位基因频率等于 $\frac{1}{2}$ 时，等位基因频率的随机变化幅度最大，而更高或更低的等位基因频率则会导致更小的随机变化幅度。这是因为当 $p=\frac{1}{2}$ 时，二项分布随机抽样的方差最大。在Wright Fisher模型中，经过一代随机漂变后的等位基因频率方差由二项分布方差给出，为 $pq/(2N)$ 。当 $p=0$ 或 $p=1$ 时，方差降为0。在Moran模型中，单次出生/死亡事件所产生的方差为 $2pq/(2N)^2$ 。这看起来与Wright Fisher模型中的方差非常不同，然而，将个体出生和死亡转换为整个人口的更替还需要乘以数学因子 $2N$ 。此时，分子中仍有因子2，这反映了一个微妙的事实，即在Moran模型中，每个个体的后代数量的方差是Wright Fisher模型的两倍（Ewens 2004）。不论是哪一种关于随机漂变的方差公式都清楚的表明了一个事实，即更大的群体在遗传漂变过程中，等位基因频率的改变速率更慢，因为二项分布随机抽样的方差大小与群体大小成反比。

------------

**问题3.4**

模拟随机漂变可能是一个非常耗时的命题。如果要模拟一个大小为1000的群体在1000代中的遗传漂变，需要进行 $10^6$ 次随机数的生成，并根据随机数决定接受或拒绝每个基因型。木村资生（Kimura Motoo）（1980b）提出了一个与扩散近似的原理（见下一节）非常接近的捷径。这里的诀窍就是使用递归： $p'=p+(2U-1)\sqrt{(3pq/2N)}$ ，其中 $U$ 是一个均匀分布在0和1之间的随机数。在每一代中，你选择一个随机数 $U$ ，然后根据上述递归式计算下一代等位基因频率的实现值。为什么这种方法有效？（提示：均匀分布的方差是取值范围长度的平方除以12）

--------

**答案:**

表达式 $2U-1$ ，其中 $U$ 是介于0和1之间的数字，因此这个表达式产生的数值在-1到+1之间，值域的长度范围为2。因此， $(2U-1)\sqrt{(3pq/2N)}$ 的值域范围为 $2\sqrt{(3pq/2N)}$ 。将这个表达式平方并除以12，这个均匀随机变量的方差等于 $pq/2N$ ，这正是二项抽样分布的方差。每一代的等位基因频率都有相同的增加或减少的机会，等位基因频率变化的方差为 $pq/2N$ 【这与Wright Fisher模型给出的方差一致】。即使在伪抽样模拟中等位基因的频率变化的分布是均匀的，使用这一递推过程过程依然可以在使用很少的计算时间的前提下再现暴力模拟的大部分结果。请注意，作为在计算时间和结果精确性之间进行权衡的结果，当计算结果接近等位基因固定状态时必须稍加小心，因为这种算法可以产生小于0或大于1的等位基因频率。

-------------------

## 3.3 扩散近似

图3.4所示的等位基因频率变化模式与理想群体的理论预期非常接近，如图3.5所示。该分布是通过矩阵的连续乘法获得的，矩阵的元素由方程（3.2）中的转移概率给出。尽管全面的随机遗传漂变理论涉及的数学知识超出了本书范围（参见Kimura 1955，1964，1976；Wright 1969；Crow和Kimura 1970；Kimura和Ohta 1971；Ewens 2004），但在下一节中，我们提供了一个介绍性的花絮以让读者们浅尝一下。如果你是一个没有微积分背景的学生，这些讨论可能显得有些难以理解，但请不要气馁，因为对这一部分的理解与否并不影响对本章的其余部分或本书后面的任何内容的理解。

### 一种前向方法

连续矩阵乘法的一个优雅的替代方案是基于扩散近似的（Fisher 1922；Wright 1945；Kimura 19571964）。扩散近似假设随机漂变以类似于通过金属棒的热扩散或在布朗运动下的微小粒子扩散的方式在亚群中分散等位基因频率（Kolmogorov 1931）。这里的想法是假设亚群足够大，因此等位基因频率随时间的变化是平滑的，没有大幅跳跃。那么，任何时间的等位基因频率的统计分布都是一个连续函数，我们可以将其表示为 $\phi(p,x;t)$ ，其中 $x$ 表示 $t$ 时间时在大量的分离群体中的等位基因频率 $(0<x<1)$， $p$ 是这些群体中的初始频率。理论问题是建立一个描述 $\phi(p,x;t)$ 在随机遗传漂变下如何变化的方程，并求解该方程。在任何时间 $t$ ，函数 $\phi(p,x;t)$ 是一个平滑的连续函数，近似于图3.5中亚群体中等位基因频率的直方图，除了 $\phi(p,x;t)$ 只与A和a等位基因未固定的亚群有关。

实际上，有两种方法可以获得扩散方程，每种方法都有优点和局限性。一种方法是询问随着时间的推移，分布 $\phi(p,x;t)$ 的变化情况。为了解释方程的含义，我们将允许 $x$ 和 $t$ 以一个微小的、离散的增量 $\Delta x$ 和 $\Delta t$ 发生改变。有两个原因可以解释为什么状态 $x$ 会随着时间 $\Delta t$ 的改变而改变。一个原因是随机的遗传漂变，另一种是可能系统性力量，包括突变或选择。我们将假设A是受欢迎的等位基因，并将 $M(x)$ 定义为 $x$ 在系统性力量下以 $\Delta x$ 增加的概率。随机漂变的力量用概率 $V(x)$ 表示，即 $x$ 在随机漂变的力量下有 $V(x)/2$ 的概率增加 $\Delta x$ ，或者 $V(x)/2$ 的概率减小 $\Delta x$ 。因此，在任何时间段 $\Delta t$ 之后，等位基因频率 $x$ 依然保持为 $x$ 的概率为 $1-M(x)-V(x)$ 。

![](asset/tab3.1.png)

这其中的原因如表3.1所示。由于等位基因频率的状态变化仅限于 $+\Delta x$ 或 $-\Delta x$ ，对于一个群体，要想其在时间 $t+\Delta t$ 时处于状态 $x$ ，其在时间 $t$ 的状态只能是 $x+\Delta x,\ x, x-\Delta x$ 中的一种，它们各自的概率分别为 $\phi(p,x+\Delta x;t),\ \phi(p,x;t),\ \phi(p,x-\Delta x;t)$ 。一个处于状态 $x+\Delta x$ 的亚群转变为状态 $x$ 的概率为 $M(x-\Delta x)+V(x-\Delta x)/2$ ，取决于它是由系统性力量（例如，突变或选择）推动，还是由于随机漂变而随机改变。处于状态 $x+\Delta x$ 的亚群通过随机漂变达到状态 $x$ 的概率为 $V(x-\Delta x)/2$ 。最后，一个处于状态 $x$ 的亚群可以以 $1-M(x)-V(x)$ 的概率继续保持在 $x$ 状态。 $\phi(p,x;t)$ 所需的函数可以通过对表3.1中第2列和第4列相乘的结果求和而得到，其经过一些简化后，可以得到下面的差分方程：

$$
\begin{aligned}
    &\phi(p,x;t+\Delta t)-\phi(p,x;t)=\\
    &-[M(x)\phi(p,x;t)-M(x-\Delta x)\phi(p,x-\Delta x;t)]\\
    &+\frac{1}{2}\{
        [V(x+\Delta x)\phi(p,x+\Delta x;t)-V(x)\phi(p,x;t)]\\
    &-[V(x)\phi(p,x;t)-V(x-\Delta x)\phi(p,x-\Delta x;t)]\}
\end{aligned}
$$

等号左边的部分是在时间 $t$ 的改变量为 $\Delta t$ 时，函数 $\phi$ 的变化 $\Delta\phi$ 。在等号右边，第一项是等位基因频率 $x$ 的改变量为 $\Delta x$ 时，$M\phi$ 的改变量 $\Delta M\phi$ ，而第二项是在 $x$ 的两步改变量 $\Delta\Delta x$ 下， $V\phi$ 的改变量 $\Delta\Delta V\phi$ 。上面的差分方程用符号表示为：

$$
\frac{\Delta\phi(p,x;t)}{\Delta t}=
-\frac{\Delta[M(x)\phi(p,x;t)]}{\Delta x}
+\frac{1}{2}\frac{\Delta\{\Delta[V(x)\phi(p,x;t)]\}}{\Delta(\Delta x)}
$$

这里我们可以取一个极限 $\Delta t\rightarrow 0,\ \Delta x\rightarrow 0$ （同时忽略了一些技术细节），从而得到了所谓的 **柯尔莫哥洛夫前向方程（Kolmogorov forward equation）** ：

$$
\frac{\partial\phi(p,x;t)}{\partial t}=
-\frac{\partial[M(x)\phi(p,x;t)]}{\partial x}
+\frac{1}{2}\frac{\partial^2[V(x)\phi(p,x;t)]}{\partial x^2} \tag{3.4}
$$

这是一个偏微分方程，对于给定的初始函数值 $\phi(p,x;0)$ ，我们都可以求出 $\phi(p,x;t)$ （尽管求解的过程并不简单）。我们还没有确定 $M(x)$ 或 $V(x)$ 是否与群体遗传学有任何关系。函数 $M(x)$ 代表了一代中由于任何系统性力量（如突变、迁移或选择）而发生的等位基因频率变化。函数 $V(x)$ 也有直接的生物学解释； $V(x)$ 是根据方程（3.1）对 $2N$ 个等位基因进行一个世代的二项抽样后的等位基因频率的方差；因此  $V(x)=x(1-x)/(2N)$ 。

![](asset/fig3.6.png)

Wright（1931）探索了方程（3.4）的许多方面，Kimura（1955）发现了该方程的形式解，这些形式解需要一些复杂的数学知识。对于我们的目的，一些图表可以用来说明前向扩散方程的重要性质。图3.6的曲线展示了 $M(x)=0$ 的解，这些曲线展示了在等位基因未固定的群体中，经过了一系列时间 $t$ 后，等位基因频率的理论分布，其中时间 $t$ 的单位是 $N$ 代。图3.6A中，所有群体的起始频率均为 $\frac{1}{2}$ ，这与图3.4中的实际群体一样；在经过 $t=2N$ 代的时间后，等位基因频率的分布基本上平坦了，此时大约有一半的群体等位基因仍未固定。图3.6中的概率分布仅涉及那些未固定的群体；随着时间的推移，越来越多的群体固定了两个等位基因之一，概率分布逐渐堆积在0和1处，如图3.4中的直方图所示。实际上，在图3.6中，每条曲线下的面积等于未固定群体在所有群体中的占比，随着时间推移，这一比例在逐渐变小。特别是，一旦曲线变平，概率分布曲线的高度会以每代 $1/(2N)$ 的速率降低。为了说明扩散近似和Wright-Fisher模型给出的结果非常相似，图3.7显示了图3.4中数据的扩散近似，其中 $2N=32,\ P_0=\frac{1}{2}$ ， $t$ 的范围从第1代到第19代。

![](asset/fig3.7.png)

图3.6B显示了当初始等位基因频率为0.1时发生的情况；这里的分布是高度不对称的，等位基因频率的分布直到约 $t=4N$ 代才变得平坦，此时只有约10%的群体未固定。一旦等位基因的频率达到平坦分布，这一分布将继续保持平坦，但随机漂变仍在继续，直到所有群体完成对等位基因的固定或丢失。

### 一种后向方法

为了找到 $\phi(p,x;t)$ 的另一个方程，我们还可以回溯到过程的开始，并考虑在第一个时间增量 $\Delta t$ 中可能发生的情况。由于亚群最初都以等位基因频率 $p$ 开始，在第一个时长增量 $\Delta t$ 之后，一个特定的亚群的状态可以变为 $p+\Delta p,\ p-\Delta t$ ，或者保持在 $p$ 。这三种情况的相对概率分别是 $M(p)+V(p)/2,\ V(p)/2,\ 1-M(p)-V(p)$ ，与上一节一样， 这里的 $M(p)$ 测量了任何倾向于增加等位基因频率的系统性力量的强度， $V(p)$ 代表了由于随机遗传漂变导致的等位基因频率方差。

![](asset/tab3.2.png)

我们可以列出这种情况下的等位基因频率变化表，如表3.2所示。当 $p$ 在第一个时间增量之后变为 $p+\Delta p$ ，则亚群体在随后的 $t-\Delta t$ 时间单位后达到状态 $x$ 的概率与  $\phi(p+\Delta p,x;t-\Delta t)$ 成正比。类似的，从状态 $p-\Delta p$ 经过 $t-\Delta t$ 个单位的时间间隔后到达状态 $x$ 的概率与  $\phi(p-\Delta p,x;t-\Delta t)$ 成正比。最后，从 $\Delta t$ 时刻的状态 $p$ 到达 $t$ 时刻的状态 $x$ 的概率与 $\phi(p,x;t-\Delta t)$ 成正比。通过对表3.2中第2列和第3列的乘积求和，得到 $\phi(p,x;t)$ 的相关方程。经过一些重新排列后，我们得到下面的式子：

$$
\begin{aligned}
    &\phi(p,x;t)-\phi(p,x;t-\Delta t)=\\
    &M(p)[\phi(p+\Delta p,x;t-\Delta t)-\phi(p,x;t-\Delta t)]\\
    &+\frac{V(p)}{2}\{
        [\phi(p+\Delta p,x;t-\Delta t)-\phi(p,x;t-\Delta t)]\\
        &-[\phi(p,x;t-\Delta t)-\phi(p-\Delta p,x;t-\Delta t)]\}
\end{aligned}
$$

和之前一样，等号左边的式子等于在给定的时间 $t$ 的变化量 $\Delta t$ 中， $\phi$ 的变化量 $\Delta\phi$ 。对于等号右边的式子，第一项是在给定频率 $p$ 的变化量 $\Delta p$ 下， $M(p)$ 乘 $\phi$ 的变化量 $M\Delta\phi$ ；第二项是在给定频率 $p$ 的两步变化量 $\Delta\Delta p$ 下， $V(p)$ 乘 $\phi$ 的变化量 $V\Delta\Delta\phi$ 。因此，上述差分方程可以写成：

$$
\frac{\Delta \phi(p,x;t)}{\Delta t}=M(p)\frac{\Delta \phi(p,x;t)}{\Delta p}+\frac{V(p)}{2}\frac{\Delta(\Delta \phi(p,x;t))}{\Delta(\Delta p)}
$$

同样的，我们可以忽略一些技术细节，并取极限 $\Delta t\rightarrow 0,\ \Delta p\rightarrow 0$ ，就可以将上述差分方程变为下面的偏微分方程，即所谓的 **柯尔莫哥洛夫后向方程（Kolmogorov backward equation）** ：

$$
\frac{\partial\phi(p,x;t)}{\partial t}=M(p)\frac{\partial\phi(p,x;t)}{\partial p}
+\frac{V(p)}{2}\frac{\partial^2\phi(p,x;t)}{\partial p^2} \tag{3.5}
$$

为了回答群体遗传学中我们对随机漂变感兴趣的问题，柯尔莫哥洛夫后向方程（见方程3.5）通常比前向方程（参见方程3.4）更有用。这些感兴趣的问题包括等位基因最终固定的概率、最终固定的等位基因的平均固定时间等。为了理解后向方程是如何用于这些问题的，想象一下方程（3.5）中的时间 $t$ 足够大，此时等位基因频率 $\phi(p,x;t)$ 的分布不再改变。
由于只要任何亚群仍然是多态的，随机漂变将继续改变等位基因的频率，因此 $\phi(p,x;t)$ 不再变化意味着所有亚群都固定了两个等位基因之一，这进一步意味着方程（3.5）的等号左边等于0，等号右边不再取决于 $x$ （因为没有种群的等位基因仍然处于分离状态）或 $t$ 。为了强调我们现在处理的是单变量函数，群体遗传学家经常将方程3.5的形式改写为

$$
0=M(p)\frac{du(p)}{dp}+\frac{V(p)}{2}\frac{d^2u(p)}{dp^2} \tag{3.6}
$$

在这个方程中，微分符号 $d$ 代替了偏导数的符号 $\partial$ ，这是为了强度函数 $u(p)$ 是一个单变量函数。换句话说， $u(p)$ 是在给定的初始频率 $p$ 下，等位基因A最终被固定的概率。或者说， $u(p)$ 可以解释为最终固定了等位基因A的亚群在所有亚群中的比例。在没有系统性力量的纯随机漂变的情况下， $M(p)=0$ ，则方程（3.6）变为

$$
0=\frac{V(p)}{2}\frac{d^2u(p)}{dp^2} \tag{3.7}
$$

这个方程定义了一系列曲线，但群体遗传学中感兴趣的曲线具有性质 $u(0)=0$ ，这意味着不存在的等位基因无法固定，同时还有性质 $u(1)=1$ ，这意味著已经固定的等位基因会永远保持固定状态。

-------------

**问题3.5**

对于拥有初始频率 $p$ （ $0<p<1$ ）的等位基因A，证明 $u(p)=p$ 是微分方程（3.7）的解。

-------------

**答案**

我们需要证明的是， $u(p)=p$ 满足微分方程（3.7）。尽管 $V(p)=p(1-p)/2N$ ，但这与方程的解无关。 $u(p)=p$ 这个解来自于下列事实，即 $u(p)=p$ 的一阶导数 $du(p)/dp=1$ ，进而其二阶导数 $d^2u(p)/dp^2=0$ 。因此，只要 $V(p)\neq 0$ ， $u(p)=p$ 就是方程（3.7）的一个解。  $u(p)=p$ 的生物学意义如下：在随机遗传漂变的作用下，一个初始等位基因频率为 $p$ 的等位基因将有 $p$ 的概率被固定，有 $1-p$ 的概率被丢失，前提是它对生物体的生存和繁殖能力没有影响（这种等位基因通常被称为 *选择中性等位基因（selectively neutral alleles）* ）。

---------------

### 吸收时间和达到固定状态的时间

对于选择中性等位基因（如问题3.5所示），最终固定的概率等于其初始等位基因频率。对柯尔莫哥洛夫后向方程（方程3.5）的分析也得出了许多其他重要结论。这些结论包括中性等位基因固定或丢失的期望时间（假设其最终固定或丢失）。假设一个等位基因的初始频率为 $p$ ，Kimura和Ohta（1969）表明，假设一个等位基因最终固定，则其固定前的平均时间 $\bar t_1(p)$ 为（时间单位为世代数量）：

$$
\bar t_1(p)=-4N(\frac{1-p}{p})\text{ln}(1-p) \tag{3.8}
$$

类似地，假设一个等位基因最终丢失，他们发现丢失的平均时间 $\bar t_0(p)$ 为：

$$
\bar t_0(p)=-4N(\frac{p}{1-p})\text{ln}(p) \tag{3.9}
$$

结合等式（3.8）和（3.9），一个等位基因的平均持续时间（即在群体中等位基因A和a保持分离状态、没有被群体固定的平均时间长度） $\bar t(p)$ 由式子 $\bar t(p)=p\bar t_1(p)+(1-p)\bar t_0(p)$ 给出，其等于

$$
\bar t(p)=-4N[(1-p)\text{ln}(1-p)+p\text{ln}(p)] \tag{3.10}
$$

图3.8显示了中性等位基因的固定、丢失和持续的平均时间。当初始频率为 $p=\frac{1}{2}$ 时群体保持不固定的平均时间最长，约为 $2.77N$ 世代的时间。

![](asset/fig3.8.png)

当 $p=1/(2N)$ 时，即当一个新的中性突变刚刚发生并且在群体中只有一个拷贝时，通过方程（3.8）和（3.9）得到的结果特别有趣。在这种情况下，这个新出现的等位基因最终固定的概率为 $1/(2N)$ ，并且，假设等位基因最终固定，平均固定时间约为 $4N$ 代。另一方面，一个新的中性突变最终丢失的概率为 $1-1/(2N)$ ，并且，假设该等位基因最终丢失，丢失的平均时间约为 $2\text{ln}(2N)$ 个世代。换句话说，新出现的中性等位基因如果最终被固定，则固定的过程通常需要很长时间，而如果其最终丢失，则丢失的速度很快。举个例子，对于 $N=500$ 的群体，最终固定的新中性突变需要平均2000代的时间才能固定，而最终丢失的新的中性突变平均需要少于14代的时间就会丢失。

## 3.4 细分群体中的随机漂变

大多数真实的群体被细分为更小的单位，例如，人类集中在城市、城镇和村庄；动物组成兽群、鸟群或鱼群；植物的群体也会发生空间上的聚集。这种群体细分让人联想到图3.5中的群体结构，除了一点不同，即自然界中的亚群之间并不存在遗传隔离，这是因为不同亚群之间的个体存在某种程度的 *迁移（migration）* 或者说移动，这导致了不同亚群体之间的 **基因流（gene flow）** 或者说基因交换。

然而，随机遗传漂变往往会导致亚群之间在其等位基因频率上发生分化，即使考虑到某些基因流的存在。为了了解这一点，我们考虑图3.9中所示的四个亚群体。每个亚群体的初始等位基因频率都是 $p=\frac{1}{2}$ ，并且每个亚群体在二项抽样后独立地经历随机漂变（见方程3.2）。

![](asset/fig3.9.png)

我们假设随机交配发生在任何特定的亚群中（称为亚群 $i$ ）。因此，如果第 $i$ 个亚群中A和a的等位基因频率表示为 $p_i$ 和 $q_i$ ， 则AA、Aa和aa的基因型频率可以由我们熟悉的哈迪-温伯格定律给出，分别为 $p_i^2,\ 2p_iq_i,\ q_i^2$ ；此外，图3.9中最后一列的情况代表着经过足够长的时间以后，所有亚群都固定了一个等位基因。因此，在第 $i$ 个亚群中， $p_i$ 要么等于0，要么等于1。此时，这个亚群中AA、Aa和aa的基因型频率要么分别为 $0,\ 0,\ 1$ （如果 $p_i=0$ ），要么分别为 $1,\ 0,\ 0$（ 如果 $p_i=1$ ）。这些基因型频率虽然极端，但仍满足哈迪-温伯格定律。因此，在图3.9中的任何一个亚群中，杂合子的频率是随机交配的预期频率。

图3.9中的总群体由四个亚群的总和组成，并且在总群体中存在杂合基因型的缺失。假设我们不知道亚群体结构，并从总群体中取样，就好像它是一个单一的、个体间随机交配的群体。如果我们从图3.9的最右边一列中随机取样，此时没有任何亚群的等位基因仍处于未固定状态，那么我们将获得 $p=\frac{1}{2}$ 的等位基因频率。按照哈迪-温伯格平衡的假设，我们会天真地期望基因型中的一部分是杂合的，并且杂合子的频率为 $2pq=\frac{1}{2}$ 。然而事实上，我们根本不会抽样到杂合基因型！这样一个相当矛盾的结论——尽管每个亚群内部都进行随机交配，但总群体中的杂合子数量依然不足——是有限的亚群大小与无尽的随机遗传漂变带来的结果。上面所说的这种每个亚群都处于固定状态的极端情况很容易理解：具有等位基因频率 $\frac{1}{2}$ 的群体只能由两个固定了等位基因A的亚群和两个固定了等位基因a的亚群所组成；平均等位基因频率是  $\frac{1}{2}$ ，但总群体没有杂合子。

我们现在能够量化在随机遗传漂变下，亚群等位基因频率的差异。为了有效地做到这一点，我们需要引入一个称为“血缘同源等位基因”（allele identity by descent）的概念。如果两个等位基因是之前某代中的基因的复制品（通过DNA复制产生），这两个等位基因就是 **血源同源（identity by descent）** 的。这一定义本身并不能说明问题，因为如果在时间上倒退得足够远，那么每对等位基因在血统上都必须是相同的，因此这个概念可能显得空洞。摆脱这个陷阱的方法是选择过去的某个任意时间（根据实际情况可以选择一个较近的时间或者较远的时间），并声明在这一刻每个等位基因都与其他等位基因不同。以这种方式，任何更早的血源同源性都会被抹掉，因此定义中所说的血源同源其实是通过DNA复制过程可以追溯到的共同祖先，这里需要考虑到刚刚指定的那个时间，因为我们宣称在那一刻，群体中的每个等位基因都是不同的。


